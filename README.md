C# version of the Core Engine